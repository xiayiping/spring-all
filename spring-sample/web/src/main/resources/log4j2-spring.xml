<?xml version="1.0" encoding="UTF-8"?>
<Configuration status="WARN" > <!-- packages="io.opentelemetry.instrumentation.log4j.appender.v2_17" -->
    <!-- packages="pl.tkowalcz.tjahzi.log4j2" -->
    <Properties>
        <Property name="LOG_EXCEPTION_CONVERSION_WORD">%xwEx</Property>
        <Property name="appName" value="${spring:spring.application.name:-App}"/>
        <Property name="profiles" value="${spring:spring.profiles.active:-default}"/>
        <Property name="logDir" value="${spring:logging.file.path:-logs}"/>

        <Property name="CONSOLE_LOG_PATTERN" value="%style{%d{HH:mm:ss.SSSZ}}{cyan} %highlight{[%-5level]}
%msg
%style{[${appName}]}{bright_magenta} %style{[%pid]}{blue}
%style{[%mdc{trace_id}%X{traceId},%mdc{span_id}%X{spanId}]}{bright_magenta}
%style{[%thread]}{bright_magenta}
%blue{%logger}$%green{%L}
%n"/>

    </Properties>

    <Appenders>
        <SpringProfile name="!dev &amp; !test">
            <RollingFile name="RollingFileRender"
                         fileName="${logDir}/app.${appName}.${profiles}.log"
                         filePattern="${logDir}/${date:yyyy-MM}/app.${appName}.${profiles}.%d{MM-dd-yyyy}-%i.log.gz">
                <PatternLayout pattern="${sys:FILE_LOG_PATTERN}"/>
                <Policies>
                    <TimeBasedTriggeringPolicy/>
                    <SizeBasedTriggeringPolicy size="25MB"/>
                </Policies>
            </RollingFile>
        </SpringProfile>

        <Console name="Console" target="SYSTEM_OUT" follow="true">
            <PatternLayout disableAnsi="false"
                           pattern="${sys:CONSOLE_LOG_PATTERN}"/>
            <filters>
                <ThresholdFilter level="${sys:CONSOLE_LOG_THRESHOLD:-TRACE}"/>
            </filters>
        </Console>
    </Appenders>
    <Loggers>
        <Logger name="org.hibernate.SQL" level="info"/>
        <Logger name="org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator" level="debug"/>
        <Logger name="org.springframework.jdbc.core.JdbcTemplate" level="debug"/>
        <Logger name="org.springframework.jdbc.core.StatementCreatorUtils" level="trace"/>
        <Logger name="org.springframework.transaction" level="debug"/>
        <Logger name="org.springframework.security" level="trace"/>
        <Logger name="org.xyp.sample" level="debug"/>
        <Root level="info">
            <AppenderRef ref="Console"/>
        </Root>
    </Loggers>
</Configuration>
